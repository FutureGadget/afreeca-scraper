version: "3.9"
services:
  scraper:
    build: .
    image: afreeca-scraper:latest
    volumes:
      - "./token:/afreeca-scraper/token"
      - "./secrets:/afreeca-scraper/secrets"
      - "./videos:/afreeca-scraper/videos"
      - "./logs:/afreeca-scraper/logs"
      - "./configs:/afreeca-scraper/configs"
    shm_size: '2gb'
    depends_on:
      - chrome
    restart: on-failure
    environment:
      - PYTHONUNBUFFERED=1 # print stdout logs immediately when `docker logs -f {containerId}`
      - ENV=dev
  
  chrome:
    image: selenium/standalone-chrome:latest
    ports:
      - "4444:4444"
    restart: always
